---
layout: mypost
title: 使用CSS3让网页动起来
categories: [html/css]
---

之前的笔记介绍了[css3-变换-渐变-动画](/posts/2016/08/20/css3-变换-渐变-动画.html)的基本使用

这介绍几个具体的实例

# 使用过渡

CSS3的transition只有在应用的元素上的属性发生变化时才会生效，所以可以把状态写在clss中，然后使用js再来改变class

```html
<style>
    #div1{
        width: 50px;
        height: 50px;
        margin-left: 200px;
        background-color: #00aa9a;
        /*为所有属性添加过渡效果*/
        transition: all 500ms ease 0ms;
    }
    .myAnimate{
        opacity: 0;
        transform: translateX(50px)
    }
</style>

<input type="button" value="出去" onclick="aniOut()">
<input type="button" value="进来" onclick="aniIn()">
<div id="div1"></div>

<script>
function aniOut() {
    document.getElementById("div1").className="myAnimate";
}
function aniIn() {
    document.getElementById("div1").className="";
}
</script>
```

![p01](01.gif)

# 使用动画

同样也可以使用CSS3的动画来实现上述效果，好处是进入，进出动画的控制比较自由

```html
<style>
    #div1{
        width: 50px;
        height: 50px;
        margin-left: 200px;
        background-color: #00aa9a;
        /*添加动画*/
        animation-duration: 1s;
        animation-fill-mode: both;
    }
    .myAnimateOut{
        animation-name: out;
    }
    .myAnimateIn{
        animation-name: in;
    }
    /*右侧飞出*/
    @keyframes out {
        0%{
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: translateX(50px);
        }
    }
    /*左侧飞入*/
    @keyframes in {
        0% {
            opacity: 0;
            transform: translateX(-2000px);
        }
        100% {
            opacity: 1;
            /*移动到左边很远的地方，不然会有滚动条*/
            transform: translateX(0px);
        }
    }
</style>

<input type="button" value="出去" onclick="aniOut()">
<input type="button" value="进来" onclick="aniIn()">
<div id="div1"></div>

<script>
    var div1 = document.getElementById("div1");

    function aniOut() {
        div1.className="myAnimateOut";
    }
    function aniIn() {
        div1.className="myAnimateIn";
    }
</script>
```

![p03](03.gif)

# 更简单的Animate.css

如果自己定义的动画帧不好看，可以使用[Animate.css](https://daneden.github.io/animate.css/)，里面定义好了了大量的动画，使用时只需要添加类就可以了

```html
<script>
    var div1 = document.getElementById("div1");

    function aniOut() {
        div1.className="animated bounceOutLeft";
    }
    function aniIn() {
        div1.className="animated bounceInLeft";
    }
</script>
```

# 一些缺陷

上面虽然实现了动画效果，要么是透明度为0，要么是移动到屏幕之外看不到了，然而还会占据空间,但是有时候希望消除元素占用的空间，所以还要为元素设置display:none

![p02](02.jpg)

主要难点就是过渡状态结束的监听

```html
<script>
    var div1 = document.getElementById("div1");
    function aniOut() {
        //防止乱点
        if (div1.className!="myAnimate hidden"){
            div1.className="myAnimate";
        }
    }
    function aniIn() {
        //先取消hidden再取消myAnimate，不然不会有动画
        if (div1.className==="myAnimate hidden"){
            div1.className="myAnimate";
            setTimeout("div1.className=''",10);
        }
    }
    //过渡结束的事件
    div1.addEventListener("transitionend", function () {
        if (div1.className==="myAnimate"){
            div1.className="myAnimate hidden";
        }
    }, true);
</script>
```

# 进入页面时局部动画实现

结合Animate.css，实现首次进入/刷新，加完成时，某些局部元素的动画

```html
<script>
    var lis = document.getElementsByTagName("li");
    var oldClassName = lis[0].className;
    window.onload  = function () {
        lis[0].className = oldClassName+" animated bounceInLeft";
        lis[1].className = oldClassName+" animated fadeInRight";
        lis[2].className = oldClassName+" animated rotateInUpLeft";
        lis[3].className = oldClassName+" animated rollIn";
        lis[4].className = oldClassName+" animated lightSpeedIn";
        setTimeout(function () {
            for(var i=0;i<lis.length;i++){
                lis[i].className = oldClassName;
            }
        },1000);
    };
</script>
```

![p04](04.gif)